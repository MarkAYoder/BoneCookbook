<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<title>Internet of Things</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="networking">Internet of Things</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction">Introduction</h3>
<div class="paragraph">
<p>You can easily connect BeagleBone Black to the Internet via a wire (<a href="#networking_wired">[networking_wired]</a>), wirelessly (<a href="#networking_wireless">[networking_wireless]</a>), or through the USB to a host and then to the Internet (<a href="#networking_usb">[networking_usb]</a>). Either way, it opens up a world of possibilities for the "Internet of Things" (IoT).</p>
</div>
<div class="paragraph">
<p>Now that you&#8217;re online, this chapter offers various things to do with your connection.</p>
</div>
</div>
<div class="sect2">
<h3 id="_accessing_your_host_computers_files_on_the_bone">Accessing Your Host Computer&#8217;s Files on the Bone</h3>
<div class="sect3">
<h4 id="_problem">Problem</h4>
<div class="paragraph">
<p>You want to access a file on a Linux host computer that&#8217;s attached to the Bone.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution">Solution</h4>
<div class="paragraph">
<p>If you are running Linux on a host computer attached to BeagleBone Black, it&#8217;s not hard to mount the Bone&#8217;s files on the host or the host&#8217;s files on the Bone by using sshfs. Suppose that you want to access files on the host from the Bone. First, install sshfs:</p>
</div>
<pre data-type="programlisting">
bone$ <strong>sudo apt install sshfs</strong>
</pre>
<div class="paragraph">
<p>Now, mount the files to an empty directory (substitute your username on the host computer for username and the IP address of the host for 192.168.7.1):</p>
</div>
<pre data-type="programlisting">
bone$ <strong>mkdir host</strong>
bone$ <strong>sshfs username@$192.168.7.1:. host</strong>
bone$ <strong>cd host</strong>
bone$ <strong>ls</strong>
</pre>
<div class="paragraph">
<p>The ls command will now list the files in your home directory on your host computer.  You can edit them as if they were local to the Bone.  You can access all the files by substituting :/ for the :. following the IP address.</p>
</div>
<div class="paragraph">
<p>You can go the other way, too. Suppose that you are on your Linux host computer and want to access files on your Bone. Install sshfs:</p>
</div>
<pre data-type="programlisting">
host$ <strong>sudo apt install sshfs</strong>
</pre>
<div class="paragraph">
<p>and then access:</p>
</div>
<pre data-type="programlisting">
host$ <strong>mkdir /mnt/bone</strong>
host$ <strong>sshfs debian@$192.168.7.2:/ /mnt/bone</strong>
host$ <strong>cd /mnt/bone</strong>
host$ <strong>ls</strong>
</pre>
<div class="paragraph">
<p>Here, we are accessing the files on the Bone as debian. We’ve mounted the entire file system, starting with /, so you can access any file. Of course, with great power comes great responsibility, so be careful.</p>
</div>
</div>
<div class="sect3">
<h4 id="_discussion">Discussion</h4>
<div class="paragraph">
<p>The sshfs command gives you easy access from one computer to another. When you are done, you can unmount the files by using the following commands:</p>
</div>
<pre data-type="programlisting">
host$ <strong>umount /mnt/bone</strong>
bone$ <strong>umount home</strong>
</pre>
</div>
</div>
<div class="sect2">
<h3 id="networking_builtin_server">Serving Web Pages from the Bone</h3>
<div class="sect3">
<h4 id="_problem_2">Problem</h4>
<div class="paragraph">
<p>You want to use BeagleBone Black as a web server.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_2">Solution</h4>
<div class="paragraph">
<p>BeagleBone Black already has the nginx web server running.</p>
</div>
<div class="paragraph">
<p>When you point your browser to <em>192.168.7.2</em>, you are using the nginx web server.  The web pages are served from <em>/var/www/html/. Add the HTML in <a href="#networking_index_html">A sample web page (test.html)</a> to a file called _/var/www/html/test.html</em>, and then point your browser to <em>192.168.7.2://test.html</em>.</p>
</div>
<div id="networking_index_html" class="exampleblock pagebreak-before">
<div class="title">Example 1. A sample web page (test.html)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;body&gt;

&lt;h1&gt;My First Heading&lt;/h1&gt;

&lt;p&gt;My first paragraph.&lt;/p&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You will see the web page shown in <a href="#networking_node_page">test.html as served by nginx</a>.</p>
</div>
<div id="networking_node_page" class="imageblock">
<div class="content">
<img src="figures/nginxTest.png" alt="test.html served by nginx">
</div>
<div class="title">Figure 1. test.html as served by nginx</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="networking_nodejs">Interacting with the Bone via a Web Browser</h3>
<div class="sect3">
<h4 id="_problem_3">Problem</h4>
<div class="paragraph">
<p>BeagleBone Black is interacting with the physical world nicely and you want to display that information on a web browser.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_3">Solution</h4>
<div class="paragraph">
<p><a href="https://www.fullstackpython.com/flask.html">Flask</a> is a Python web framework built with a small core and easy-to-extend philosophy. <a href="#networking_builtin_server">Serving Web Pages from the Bone</a> shows how to use nginx, the web server that&#8217;s already running. This recipe shows how easy it is to build your own server. This is an adaptation of <a href="https://towardsdatascience.com/python-webserver-with-flask-and-raspberry-pi-398423cc6f5d">Python WebServer With Flask and Raspberry Pi</a>.</p>
</div>
<div class="paragraph">
<p>First, install flask:</p>
</div>
<pre data-type="programlisting">
bone$ <strong>sudo apt update</strong>
bone$ <strong>sudo apt install python3-flask</strong>
</pre>
<div class="paragraph">
<p>All the code in is the Cookbook repo:</p>
</div>
<pre data-type="programlisting">
bone$ <strong>git clone https://github.com/MarkAYoder/BoneCookbook</strong>
bone$ <strong>cd BoneCookbook/doc/06iod/code/flash</strong>
</pre>
<div class="sect4">
<h5 id="_first_flask_hello_world">First Flask - hello, world</h5>
<div class="paragraph">
<p>Our first example is <strong>helloWorld.py</strong></p>
</div>
<div id="flask_hello_world" class="exampleblock">
<div class="title">Example 2. Python code for flask hello world (helloWorld.py)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">#!/usr/bin/env python
# From: https://towardsdatascience.com/python-webserver-with-flask-and-raspberry-pi-398423cc6f5d

from flask import Flask     # <b class="conum">(1)</b>
app = Flask(__name__)       # <b class="conum">(2)</b>
@app.route('/')             # <b class="conum">(3)</b>
def index():
    return 'hello, world'
if __name__ == '__main__':
    app.run(debug=True, port=8080, host='0.0.0.0')# <b class="conum">(4)</b></code></pre>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The first line loads the Flask module into your Python script.</p>
</li>
<li>
<p>The second line creates a Flask object called <em>app</em>.</p>
</li>
<li>
<p>The third line is where the action is, it says to run the index() function when someone accesses the root URL (‘/’) of the server. In this case, send the text “hello, world” to the client’s web browser via return.</p>
</li>
<li>
<p>The last line says to “listen” on port 8080, reporting any errors.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now on your host computer, browse to 192.168.7.2:8080 and you should see.</p>
</div>
<div id="flask_flaskServer" class="imageblock">
<div class="content">
<img src="figures/flaskServer.png" alt="Test page">
</div>
<div class="title">Figure 2. Test page served by our custom flask server</div>
</div>
</div>
<div class="sect4">
<h5 id="_adding_a_template">Adding a template</h5>
<div class="paragraph">
<p>Let’s improve our “hello, world” application, by using an HTML template and a CSS file for styling our page.  Note: these have been created for you in the “templates” sub-folder. So, we will create a file named <strong>index1.html</strong>, that has been saved in <strong>/templates</strong>.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s what&#8217;s in <strong>templates/index1.html</strong>:</p>
</div>
<div id="flask_index1" class="exampleblock">
<div class="title">Example 3. html code for flask hello world (index1.html)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
   &lt;head&gt;
      &lt;title&gt;{{ title }}&lt;/title&gt;
   &lt;/head&gt;
   &lt;body&gt;
      &lt;h1&gt;Hello, World!&lt;/h1&gt;
      &lt;h2&gt;The date and time on the server is: {{ time }}&lt;/h2&gt;
   &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note: a style sheet (style.css) is also included. This will be populated later.</p>
</div>
<div class="paragraph">
<p>Observe that anything in double curly braces within the HTML template is interpreted as a variable that would be passed to it from the Python script via the render_template function. Now, let’s create a new Python script. We will name it app1.py:</p>
</div>
<div id="flask_app1" class="exampleblock">
<div class="title">Example 4. Python code for flask index1.html (app1.py)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">#!/usr/bin/env python
# From: https://towardsdatascience.com/python-webserver-with-flask-and-raspberry-pi-398423cc6f5d

'''
Code created by Matt Richardson 
for details, visit:  http://mattrichardson.com/Raspberry-Pi-Flask/inde...
'''
from flask import Flask, render_template
import datetime
app = Flask(__name__)
@app.route("/")
def hello():
   now = datetime.datetime.now()
   timeString = now.strftime("%Y-%m-%d %H:%M")
   templateData = {
      'title' : 'HELLO!',
      'time': timeString
      }
   return render_template('index1.html', **templateData)
if __name__ == "__main__":
   app.run(host='0.0.0.0', port=8080, debug=True)</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that we create a formatted string("timeString") using the date and time from the "now" object, that has the current time stored on it.</p>
</div>
<div class="paragraph">
<p>Next important thing on the above code, is that we created a dictionary of variables (a set of keys, such as the title that is associated with values, such as HELLO!) to pass into the template. On “return”, we will return the index.html template to the web browser using the variables in the templateData dictionary.</p>
</div>
<div class="paragraph">
<p>Execute the Python script:</p>
</div>
<pre data-type="programlisting">
bone$ <strong>.\app1.py</strong>
</pre>
<div class="paragraph">
<p>Open any web browser and browse to 192.168.7.2:8080. You should see:</p>
</div>
<div id="flask_app1_fig" class="imageblock">
<div class="content">
<img src="figures/flaskapp1.png" alt="app1.py">
</div>
<div class="title">Figure 3. Test page served by app1.py</div>
</div>
<div class="paragraph">
<p>Note that the page’s content changes dynamically any time that you refresh it with the actual variable data passed by Python script. In our case, “title” is a fixed value, but “time” changes every second.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_displaying_gpio_status_in_a_web_browser_reading_a_button">Displaying GPIO Status in a Web Browser - reading a button</h3>
<div class="sect3">
<h4 id="_problem_4">Problem</h4>
<div class="paragraph">
<p>You want a web page to display the status of a GPIO pin.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_4">Solution</h4>
<div class="paragraph">
<p>This solution builds on the Flask-based web server solution in <a href="#networking_nodejs">Interacting with the Bone via a Web Browser</a>.</p>
</div>
<div class="paragraph">
<p>To make this recipe, you will need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Breadboard and jumper wires</p>
</li>
<li>
<p>Pushbutton switch</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Wire your pushbutton as shown in <a href="#js_pushbutton_fig">[js_pushbutton_fig]</a>.</p>
</div>
<div class="paragraph">
<p>Wire a button to <strong>P9_11</strong> and have the web page display the value of the button.</p>
</div>
<div class="paragraph">
<p>Let’s use a new Python script named <strong>app2.py</strong>.</p>
</div>
<div id="flask_app2" class="exampleblock">
<div class="title">Example 5. A simple Flask-based web server to read a GPIO (app2.py)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">#!/usr/bin/env python
# From: https://towardsdatascience.com/python-webserver-with-flask-and-raspberry-pi-398423cc6f5d
import os
from flask import Flask, render_template
app = Flask(__name__)

# gpioinfo | grep -e chip -e P9_11
pin = '30' #  P9_11 is gpio 30
GPIOPATH="/sys/class/gpio"
buttonSts = 0

# Make sure pin is exported
if (not os.path.exists(GPIOPATH+"/gpio"+pin)):
    f = open(GPIOPATH+"/export", "w")
    f.write(pin)
    f.close()

# Make it an input pin
f = open(GPIOPATH+"/gpio"+pin+"/direction", "w")
f.write("in")
f.close()

@app.route("/")
def index():
	# Read Button Status
	f = open(GPIOPATH+"/gpio"+pin+"/value", "r")
	buttonSts = f.read()[:-1]
	f.close()

	# buttonSts = GPIO.input(button)
	templateData = {
      'title' : 'GPIO input Status!',
      'button'  : buttonSts,
      }
	return render_template('index2.html', **templateData)
if __name__ == "__main__":
   app.run(host='0.0.0.0', port=8080, debug=True)</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Look that what we are doing is defining the button on <strong>P9_11</strong> as input, reading its value and storing it in <strong>buttonSts</strong>. Inside the function <strong>index()</strong>, we will pass that value to our web page through “button” that is part of our variable dictionary: <strong>templateData</strong>.</p>
</div>
<div class="paragraph">
<p>Let’s also see the new <strong>index2.html</strong> to show the GPIO status:</p>
</div>
<div id="flask_index2" class="exampleblock">
<div class="title">Example 6. A simple Flask-based web server to read a GPIO (index2.html)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
   &lt;head&gt;
      &lt;title&gt;{{ title }}&lt;/title&gt;
      &lt;link rel="stylesheet" href='../static/style.css'/&gt;
   &lt;/head&gt;
   &lt;body&gt;
	  &lt;h1&gt;{{ title }}&lt;/h1&gt;
      &lt;h2&gt;Button pressed:  {{ button }}&lt;/h1&gt;
   &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Now, run the following command:</p>
</div>
<pre data-type="programlisting">
bone$ <strong>./app2.py</strong>
</pre>
<div class="paragraph">
<p>Point your browser to <em><a href="http://192.168.7.2:8080" class="bare">http://192.168.7.2:8080</a></em>, and the page will look like <a href="#networking_GPIOserver_fig">[networking_GPIOserver_fig]</a>.</p>
</div>
<div id="flask_app2_fig" class="imageblock">
<div class="content">
<img src="figures/flaskapp2.png" alt="GPIO status">
</div>
<div class="title">Figure 4. Status of a GPIO pin on a web page</div>
</div>
<div class="paragraph">
<p>Currently, the 0 shows that the button isn&#8217;t pressed. Try refreshing the page while pushing the button, and you will see 1 displayed.</p>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_2">Discussion</h4>
<div class="paragraph">
<p>It&#8217;s not hard to assemble your own HTML with the GPIO data. It&#8217;s an easy extension to write a program to display the status of all the GPIO pins.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_controlling_gpios">Controlling GPIOs</h3>
<div class="sect3">
<h4 id="_problem_5">Problem</h4>
<div class="paragraph">
<p>You want to control an LED attached to a GPIO pin.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_5">Solution</h4>
<div class="paragraph">
<p>Now that we know how to “read” GPIO Status, let’s change them. What we will do will control the LED via the web page. We have an LED connected to <strong>P9_14</strong>. Controlling remotely we will change its status from LOW to HIGH and vice-versa.</p>
</div>
<div class="paragraph">
<p>The python script Let’s create a new Python script and named it <strong>app3.py</strong>.</p>
</div>
<div id="flask_app3" class="exampleblock">
<div class="title">Example 7. A simple Flask-based web server to read a GPIO (app3.py)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">#!/usr/bin/env python
# From: https://towardsdatascience.com/python-webserver-with-flask-and-raspberry-pi-398423cc6f5d
# import Adafruit_BBIO.GPIO as GPIO
import os
from flask import Flask, render_template, request
app = Flask(__name__)
#define LED GPIO
ledRed = "P9_14"
pin = '50' #  P9_14 is gpio 50
GPIOPATH="/sys/class/gpio"

#initialize GPIO status variable
ledRedSts = 0
# Make sure pin is exported
if (not os.path.exists(GPIOPATH+"/gpio"+pin)):
    f = open(GPIOPATH+"/export", "w")
    f.write(pin)
    f.close()
# Define led pin as output
f = open(GPIOPATH+"/gpio"+pin+"/direction", "w")
f.write("out")
f.close()
# turn led OFF 
f = open(GPIOPATH+"/gpio"+pin+"/value", "w")
f.write("0")
f.close()

@app.route("/")
def index():
	# Read Sensors Status
	f = open(GPIOPATH+"/gpio"+pin+"/value", "r")
	ledRedSts = f.read()
	f.close()
	templateData = {
              'title' : 'GPIO output Status!',
              'ledRed'  : ledRedSts,
        }
	return render_template('index3.html', **templateData)
	
@app.route("/&lt;deviceName&gt;/&lt;action&gt;")
def action(deviceName, action):
	if deviceName == 'ledRed':
		actuator = ledRed
	f = open(GPIOPATH+"/gpio"+pin+"/value", "w")
	if action == "on":
		f.write("1")
	if action == "off":
		f.write("0")
	f.close()
		     
	f = open(GPIOPATH+"/gpio"+pin+"/value", "r")
	ledRedSts = f.read()
	f.close()

	templateData = {
              'ledRed'  : ledRedSts,
	}
	return render_template('index3.html', **templateData)
if __name__ == "__main__":
   app.run(host='0.0.0.0', port=8080, debug=True)</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>What we have new on above code is the new “route”:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>@app.route("/&lt;deviceName&gt;/&lt;action&gt;")</p>
</div>
</div>
</div>
<div class="paragraph">
<p>From the webpage, calls will be generated with the format:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><a href="http://192.168.7.2:8081/ledRed/on" class="bare">http://192.168.7.2:8081/ledRed/on</a></p>
</div>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><a href="http://192.168.7.2:8081/ledRed/off" class="bare">http://192.168.7.2:8081/ledRed/off</a></p>
</div>
</div>
</div>
<div class="paragraph">
<p>For the above example, <strong>ledRed</strong> is the “deviceName” and <strong>on</strong> or <strong>off</strong> are examples of possible “action”. Those routes will be identified and properly “worked”. The main steps are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Convert the string “ledRED”, for example, on its equivalent GPIO pin.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The integer variable ledRed is equivalent to P9_14. We store this value on variable “actuator”</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For each actuator, we will analyze the “action”, or “command” and act properly.
If “action = on” for example, we must use the command: f.write("1")</p>
</li>
<li>
<p>Update the status of each actuator</p>
</li>
<li>
<p>Update the variable library</p>
</li>
<li>
<p>Return the data to index.html</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let’s now create an index.html to show the GPIO status of each actuator and more importantly, create “buttons” to send the commands:</p>
</div>
<div id="flask_index3" class="exampleblock">
<div class="title">Example 8. A simple Flask-based web server to write a GPIO (index3.html)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
   &lt;head&gt;
      &lt;title&gt;GPIO Control&lt;/title&gt;
      &lt;link rel="stylesheet" href='../static/style.css'/&gt;
   &lt;/head&gt;
   &lt;body&gt;
		&lt;h2&gt;Actuators&lt;/h2&gt;
		&lt;h3&gt; Status &lt;/h3&gt;
		     RED LED ==&gt;  {{ ledRed  }}
		&lt;br&gt;
		&lt;h3&gt; Commands &lt;/h3&gt;
			RED LED Ctrl ==&gt; 
			&lt;a href="/ledRed/on" class="button"&gt;TURN ON&lt;/a&gt;  
			&lt;a href="/ledRed/off"class="button"&gt;TURN OFF&lt;/a&gt;
   &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
</div>
<pre data-type="programlisting">
bone$ <strong>./app3.py</strong>
</pre>
<div class="paragraph">
<p>Point your browser as before and you will see:</p>
</div>
<div id="flask_app3_fig" class="imageblock">
<div class="content">
<img src="figures/flaskapp3.png" alt="Control LED">
</div>
<div class="title">Figure 5. Status of a GPIO pin on a web page</div>
</div>
<div class="paragraph">
<p>Try clicking the "TURN ON" and "TURN OFF" buttons and your LED will respond.</p>
</div>
<div class="paragraph">
<p><strong>app4.py</strong> and <strong>app5.py</strong> combine the previous apps.  Try them out.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_plotting_data">Plotting Data</h3>
<div class="sect3">
<h4 id="_problem_6">Problem</h4>
<div class="paragraph">
<p>You have live, continuous,  data coming into your Bone via one of the Analog Ins, and you want to plot it.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_6">Solution</h4>
<div class="paragraph">
<p>Analog in - Continuous
(This is based on information at: <a href="http://software-dl.ti.com/processor-sdk-linux/esd/docs/latest/linux/Foundational_Components/Kernel/Kernel_Drivers/ADC.html#Continuous%20Mode" class="bare">http://software-dl.ti.com/processor-sdk-linux/esd/docs/latest/linux/Foundational_Components/Kernel/Kernel_Drivers/ADC.html#Continuous%20Mode</a>)</p>
</div>
<div class="paragraph">
<p>Reading a continuous analog signal requires some set up. First go to the iio devices directory.</p>
</div>
<pre data-type="programlisting">
bone$ <strong>cd /sys/bus/iio/devices/iio:device0</strong>
bone$ <strong>ls -F</strong>
buffer/  in_voltage0_raw  in_voltage2_raw  in_voltage4_raw  in_voltage6_raw  name      power/          subsystem@
dev      in_voltage1_raw  in_voltage3_raw  in_voltage5_raw  in_voltage7_raw  of_node@  scan_elements/  uevent
</pre>
<div class="paragraph">
<p>Here you see the files used to read the one shot values. Look in scan_elements to see how to enable continuous input.</p>
</div>
<pre data-type="programlisting">
bone$ <strong>ls scan_elements</strong>
in_voltage0_en     in_voltage1_index  in_voltage2_type   in_voltage4_en     in_voltage5_index  in_voltage6_type
in_voltage0_index  in_voltage1_type   in_voltage3_en     in_voltage4_index  in_voltage5_type   in_voltage7_en
in_voltage0_type   in_voltage2_en     in_voltage3_index  in_voltage4_type   in_voltage6_en     in_voltage7_index
in_voltage1_en     in_voltage2_index  in_voltage3_type   in_voltage5_en     in_voltage6_index  in_voltage7_type
</pre>
<div class="paragraph">
<p>Here you see three values for each analog input, _en (enable), _index (index of this channel in the buffer’s chunks) and _type (How the ADC stores its data). (See the link above for details.) Let&#8217;s use the input at <strong>P9_40</strong> which is <strong>AIN1</strong>. To enable this input:</p>
</div>
<pre data-type="programlisting">
bone$ <strong>echo 1 > scan_elements/in_voltage1_en</strong>
</pre>
<div class="paragraph">
<p>Next set the buffer size.</p>
</div>
<pre data-type="programlisting">
bone$ <strong>ls buffer</strong>
data_available  enable  length  watermark
</pre>
<div class="paragraph">
<p>Let&#8217;s use a 512 sample buffer. You might need to experiment with this.</p>
</div>
<pre data-type="programlisting">
bone$ <strong>echo 512 > buffer/length</strong>
</pre>
<div class="paragraph">
<p>Then start it running.</p>
</div>
<pre data-type="programlisting">
bone$ <strong>echo 1 > buffer/enable</strong>
</pre>
<div class="paragraph">
<p>Now, just read from /dev/iio:device0.</p>
</div>
<div id="analog_sine_fig" class="imageblock">
<div class="content">
<img src="figures/Sine1k.png" alt="1KHz sine wave sampled at 8KHz">
</div>
<div class="title">Figure 6. 1KHz sine wave sampled at 8KHz</div>
</div>
<div class="paragraph">
<p>An example Python program that does the above and the reads and plot the buffer is here: analogInContinuous.py</p>
</div>
<div id="analog_code" class="exampleblock">
<div class="title">Example 9. Code to read and plot a continuous analog input(analogInContinuous.py)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">#!/usr/bin/python
#//////////////////////////////////////
#	analogInContinuous.py
# 	Read analog data via IIO continous mode and plots it.
#//////////////////////////////////////
# From: https://stackoverflow.com/questions/20295646/python-ascii-plots-in-terminal
# https://github.com/dkogan/gnuplotlib
# https://github.com/dkogan/gnuplotlib/blob/master/guide/guide.org
# sudo apt install gnuplot  (10 minute to install)
# sudo apt install libatlas-base-dev
# pip3 install gnuplotlib
# This uses X11, so when connecting to the bone from the host use:  ssh -X bone

# See https://elinux.org/index.php?title=EBC_Exercise_10a_Analog_In#Analog_in_-_Continuous.2C_Change_the_sample_rate
# for instructions on changing the sampling rate.  Can go up to 200KHz.

import numpy      as np
import gnuplotlib as gp
import time
# import struct

IIOPATH='/sys/bus/iio/devices/iio:device0'
IIODEV='/dev/iio:device0'
LEN = 100
SAMPLERATE=8000
AIN='2'

# Setup IIO for Continous reading
# Enable AIN
try:
    file1 = open(IIOPATH+'/scan_elements/in_voltage'+AIN+'_en', 'w')
    file1.write('1') 
    file1.close()
except:     # carry on if it's already enabled
    pass
# Set buffer length
file1 = open(IIOPATH+'/buffer/length', 'w')
file1.write(str(2*LEN))     # I think LEN is in 16-bit values, but here we pass bytes
file1.close()
# Enable continous
file1 = open(IIOPATH+'/buffer/enable', 'w')
file1.write('1')
file1.close()

x = np.linspace(0, 1000*LEN/SAMPLERATE, LEN)
# Do a dummy plot to give time of the fonts to load.
gp.plot(x, x)
print("Waiting for fonts to load")
time.sleep(10)

print('Hit ^C to stop')

fd = open(IIODEV, "r")

try:
    while True:
        y = np.fromfile(fd, dtype='uint16', count=LEN)*1.8/4096
        # print(y)
        gp.plot(x, y,
            xlabel = 't (ms)',
            ylabel = 'volts',
            _yrange = [0, 2],
            title  = 'analogInContinuous',
            legend = np.array( ("P9.39", ), ),
            # ascii=1,
            # terminal="xterm",
            # legend = np.array( ("P9.40", "P9.38"), ),
            # _with  = 'lines'
            )

except KeyboardInterrupt:
    print("Turning off input.")
    # Disable continous
    file1 = open(IIOPATH+'/buffer/enable', 'w')
    file1.write('0')
    file1.close()
    
    file1 = open(IIOPATH+'/scan_elements/in_voltage'+AIN+'_en', 'w')
    file1.write('0') 
    file1.close()

# // Bone  | Pocket | AIN
# // ----- | ------ | --- 
# // P9_39 | P1_19  | 0
# // P9_40 | P1_21  | 1
# // P9_37 | P1_23  | 2
# // P9_38 | P1_25  | 3
# // P9_33 | P1_27  | 4
# // P9_36 | P2_35  | 5
# // P9_35 | P1_02  | 6</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Be sure to read the instillation instructions in the comments. Also note this uses X windows and you need to ssh -X 192.168.7.2 for X to know where the display is.</p>
</div>
<div class="paragraph">
<p>Run it:</p>
</div>
<pre data-type="programlisting">
host$ <strong>ssh -X bone</strong>

bone$ <strong>cd <Cookbook repo>/doc/06iot/code</strong>
bone$ <strong>./analogInContinuous.py</strong>
Hit ^C to stop
</pre>
<div class="paragraph">
<p><a href="#analog_sine_fig">1KHz sine wave sampled at 8KHz</a> is the output of a 1KHz sine wave.</p>
</div>
<div class="paragraph">
<p>It&#8217;s a good idea to disable the buffer when done.</p>
</div>
<pre>
bone$ <strong>echo 0 > /sys/bus/iio/devices/iio:device0/buffer/enable</strong>
</pre>
<div class="sect4">
<h5 id="_analog_in_continuous_change_the_sample_rate">Analog in - Continuous, Change the sample rate</h5>
<div class="paragraph">
<p>The built in ADCs sample at 8k samples/second by default. They can run as fast as 200k samples/second by editing a device tree.</p>
</div>
<pre>
bone$ <strong>cd /opt/source/bb.org-overlays</strong>
bone$ <strong>make</strong>
</pre>
<div class="paragraph">
<p>This will take a while the first time as it compiles all the device trees.</p>
</div>
<pre>
bone$ <strong>vi src/arm/src/arm/BB-ADC-00A0.dts</strong>
</pre>
<div class="paragraph">
<p>Around line 57 you&#8217;ll see</p>
</div>
<pre>
Line    Code
 57     // For each step, number of adc clock cycles to wait between setting up muxes and sampling.
 58     //  range: 0 .. 262143
 59     //  optional, default is 152 (XXX but why?!)
 60     ti,chan-step-opendelay = <152 152 152 152 152 152 152 152>;
 61     //`
 62     // XXX is there any purpose to set this nonzero other than to fine-tune the sample rate?
 63
 64
 65     // For each step, how many times it should sample to average.
 66     //  range: 1 .. 16, must be power of two (i.e. 1, 2, 4, 8, or 16)
 67     //  optional, default is 16
 68     ti,chan-step-avg = <16 16 16 16 16 16 16 16>;

</pre>
<div class="paragraph">
<p>The comments give lots of details on how to adjust the device tree  to change the sample rate.
Line 68 says for every sample returned, average 16 values. This will give you a cleaner signal, but if you want to go fast, change the 16&#8217;s to 1&#8217;s. Line 60 says to delay 152 cycles between each sample. Set this to 0 to got as fast a possible.</p>
</div>
<pre>
ti,chan-step-avg = <1 1 1 1 1 1 1 1>;
ti,chan-step-opendelay = <0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00>;
</pre>
<div class="paragraph">
<p>Now compile it.</p>
</div>
<pre>
bone$ <strong>make</strong>
  DTC     src/arm/BB-ADC-00A0.dtbo
gcc -o config-pin ./tools/pmunts_muntsos/config-pin.c
</pre>
<div class="paragraph">
<p>make knows to only recompile the file you just edited. Now install and reboot.</p>
</div>
<pre>
bone$ <strong>sudo make install</strong>
...
'src/arm/AM335X-PRU-UIO-00A0.dtbo' -> '/lib/firmware/AM335X-PRU-UIO-00A0.dtbo'
'src/arm/BB-ADC-00A0.dtbo' -> '/lib/firmware/BB-ADC-00A0.dtbo'
'src/arm/BB-BBBMINI-00A0.dtbo' -> '/lib/firmware/BB-BBBMINI-00A0.dtbo'
...
bone$ <strong>reboot</strong>
</pre>
<div class="paragraph">
<p>A number of files get installed, including the ADC file. Now try rerunning.</p>
</div>
<pre>
bone$ <strong>cd <Cookbook repo>/docs/06iot/code></strong>
bone$ <strong>./analogInContinuous.py</strong>
Hit ^C to stop
</pre>
<div class="paragraph">
<p>Here&#8217;s the output of a 10KHz triangle wave.</p>
</div>
<div id="analog_tri_fig" class="imageblock">
<div class="content">
<img src="figures/Tri10k.png" alt="10KHz triangle wave sampled at 200KHz">
</div>
<div class="title">Figure 7. 10KHz triangle wave sampled at 200KHz</div>
</div>
<div class="paragraph">
<p>It&#8217;s still a good idea to disable the buffer when done.</p>
</div>
<pre>
bone$ </strong>echo 0 > /sys/bus/iio/devices/iio:device0/buffer/enable</strong>
</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sending_an_email">Sending an Email</h3>
<div class="sect3">
<h4 id="_problem_7">Problem</h4>
<div class="paragraph">
<p>You want to send an email via Gmail from the Bone.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_7">Solution</h4>
<div class="paragraph">
<p>This example came from <a href="https://realpython.com/python-send-email/" class="bare">https://realpython.com/python-send-email/</a>.
First, you need to <a href="https://mail.google.com">set up a Gmail account</a>, if you don&#8217;t already have one. Then add the code in <a href="#networking_nodemailer_code">Sending email using nodemailer (emailTest.py)</a> to a file named <em>emailTest.py</em>. Substitute your own Gmail username.  For the password:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go to: <a href="https://myaccount.google.com/security" class="bare">https://myaccount.google.com/security</a></p>
</li>
<li>
<p>Select App password.</p>
</li>
<li>
<p>Generate your own 16 char password and copy it into <em>emailTest.py</em>.</p>
</li>
<li>
<p>Be sure to delete password when done <a href="https://myaccount.google.com/apppasswords" class="bare">https://myaccount.google.com/apppasswords</a> .</p>
</li>
</ul>
</div>
<div id="networking_nodemailer_code" class="exampleblock">
<div class="title">Example 10. Sending email using nodemailer (emailTest.py)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">#!/usr/bin/env python
# From: https://realpython.com/python-send-email/
import smtplib, ssl

port = 587  # For starttls
smtp_server  = "smtp.gmail.com"
sender_email = "from_account@gmail.com"
receiver_email = "to_account@gmail.com"
# Go to: https://myaccount.google.com/security
# Select App password
# Generate your own 16 char password, copy here
# Delete password when done
password = "cftqhcejjdjfdwjh"
message = """\
Subject: Testing email

This message is sent from Python.

"""
context = ssl.create_default_context()
with smtplib.SMTP(smtp_server, port) as server:
    server.starttls(context=context)
    server.login(sender_email, password)
    server.sendmail(sender_email, receiver_email, message)</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then run the script to send the email:</p>
</div>
<pre data-type="programlisting">
bone$ <strong>chmod +x emailTest.py</strong>
bone$ <strong>.\emailTest.py</strong>
</pre>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>This solution requires your Gmail password to be in plain text in a file, which is a security problem. Make sure you know who has access to your Bone. Also, if you remove the microSD card, make sure you know who has access to it. Anyone with your microSD card can read your Gmail password.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_3">Discussion</h4>
<div class="paragraph">
<p>Be careful about putting this into a loop.  Gmail presently limits you to <a href="http://group-mail.com/email-marketing/how-to-send-bulk-emails-using-gmail/">500 emails per day and 10 MB per message</a>.</p>
</div>
<div class="paragraph">
<p>See <a href="https://realpython.com/python-send-email/" class="bare">https://realpython.com/python-send-email/</a> for an example that sends an attached file.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_displaying_the_current_weather_conditions">Displaying the Current Weather Conditions</h3>
<div class="sect3">
<h4 id="_problem_8">Problem</h4>
<div class="paragraph">
<p>You want to display the current weather conditions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_8">Solution</h4>
<div class="paragraph">
<p>Because your Bone is on the network, it&#8217;s not hard to access the current weather conditions from a weather API.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go to <a href="https://openweathermap.org/" class="bare">https://openweathermap.org/</a> and create an account.</p>
</li>
<li>
<p>Go to <a href="https://home.openweathermap.org/api_keys" class="bare">https://home.openweathermap.org/api_keys</a> and get your API key.</p>
</li>
<li>
<p>Store your key in the bash variable APPID.</p>
</li>
</ul>
</div>
<pre>
bash$ <strong>export APPID="Your key"</strong>
</pre>
<div class="ulist">
<ul>
<li>
<p>Then add the code in <a href="#networking_weather_code">Code for getting current weather conditions (<em>weather.py</em>)</a> to a file named <em>weather.js</em>.</p>
</li>
<li>
<p>Run the pyhon script.</p>
</li>
</ul>
</div>
<div id="networking_weather_code" class="exampleblock">
<div class="title">Example 11. Code for getting current weather conditions (<em>weather.py</em>)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">#!/usr/bin/env python3
# Displays current weather and forcast
import os
import sys
from datetime import datetime
import requests     # For getting weather
                
# http://api.openweathermap.org/data/2.5/onecall
params = {
    'appid': os.environ['APPID'],
    # 'city': 'brazil,indiana',
    'exclude': "minutely,hourly",
    'lat':  '39.52',
    'lon': '-87.12',
    'units': 'imperial'
    }
urlWeather = "http://api.openweathermap.org/data/2.5/onecall"

print("Getting weather")

try:
    r = requests.get(urlWeather, params=params)
    if(r.status_code==200):
        # print("headers: ", r.headers)
        # print("text: ", r.text)
        # print("json: ", r.json())
        weather = r.json()
        print("Temp: ", weather['current']['temp'])         # <b class="conum">(1)</b>
        print("Humid:", weather['current']['humidity'])
        print("Low:  ", weather['daily'][1]['temp']['min'])
        print("High: ", weather['daily'][0]['temp']['max'])
        day = weather['daily'][0]['sunrise']-weather['timezone_offset']
        print("sunrise: " + datetime.utcfromtimestamp(day).strftime('%Y-%m-%d %H:%M:%S'))
        # print("Day: " + datetime.utcfromtimestamp(day).strftime('%a'))
        # print("weather: ", weather['daily'][1])           # <b class="conum">(2)</b>
        # print("weather: ", weather)                       # <b class="conum">(3)</b>
        # print("icon: ", weather['current']['weather'][0]['icon'])
        # print()

    else:
        print("status_code: ", r.status_code)
except IOError:
    print("File not found: " + tmp101)
    print("Have you run setup.sh?")
except:
    print("Unexpected error:", sys.exc_info())</code></pre>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Prints current conditions.</p>
</li>
<li>
<p>Prints the forecast for the next day.</p>
</li>
<li>
<p>Prints everything returned by the weather site.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Run this by using the following commands:</p>
</div>
<pre data-type="programlisting">
bone$ <strong>./weather.js</strong>
Getting weather
Temp:  85.1
Humid: 50
Low:   62.02
High:  85.1
sunrise: 2022-07-14 14:32:46
</pre>
</div>
<div class="sect3">
<h4 id="_discussion_4">Discussion</h4>
<div class="paragraph">
<p>The weather API returns lots of information. Use Python to extract the information you want.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sending_and_receiving_tweets">Sending and Receiving Tweets</h3>
<div class="sect3">
<h4 id="_problem_9">Problem</h4>
<div class="paragraph">
<p>You want to send and receive tweets (Twitter posts) with your Bone.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_9">Solution</h4>
<div class="paragraph">
<p><a href="https://twitter.com/">Twitter</a> has a whole <a href="https://github.com/twitterdev/Twitter-API-v2-sample-code">git repo</a> of sample code for interacting with Twitter.  Here I&#8217;ll show how to create a tweet and then how to delete it.</p>
</div>
<div class="sect4">
<h5 id="_creating_a_project_and_app">Creating a Project and App</h5>
<div class="ulist">
<ul>
<li>
<p>Follow the <a href="https://developer.twitter.com/en/docs/apps/overview">directions here</a> to create a project and and app.</p>
</li>
<li>
<p>Be sure to give your app Read and Write permission.</p>
</li>
<li>
<p>Then go to the <a href="https://developer.twitter.com/en/portal/projects-and-apps">developer portal</a> and select your app by clicking on the gear icon to the right of the app name.</p>
</li>
<li>
<p>Click on the <strong>Keys and tokens</strong> tab. Here you can get to all your keys and tokens.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Be sure to record them, you can&#8217;t get them later.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Open the file twitterKeys.sh and record your keys in it.</p>
</li>
</ul>
</div>
<pre data-type="programlisting">
export API_KEY='XXX'
export API_SECRET_KEY='XXX'
export BEARER_TOKEN='XXX'
export TOKEN='4XXX'
export TOKEN_SECRET='XXX'
</pre>
<div class="ulist">
<ul>
<li>
<p>Next, source the file so the values will appear in your bash session.</p>
</li>
</ul>
</div>
<pre>
bash$ <strong>source twitterKeys.sh</strong>
</pre>
<div class="paragraph">
<p>You&#8217;ll need to do this every time you open a new bash window.</p>
</div>
</div>
<div class="sect4">
<h5 id="_creating_a_tweet">Creating a tweet</h5>
<div class="paragraph">
<p>Run <em>twitter_create_tweet</em>.py_ to see your timeline.</p>
</div>
<div id="twitter_create_code" class="exampleblock">
<div class="title">Example 12. Create a Tweet (<em>twitter_create_tweet.py</em>)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">#!/usr/bin/env python
# From: https://github.com/twitterdev/Twitter-API-v2-sample-code/blob/main/Manage-Tweets/create_tweet.py
from requests_oauthlib import OAuth1Session
import os
import json

# In your terminal please set your environment variables by running the following lines of code.
# export 'API_KEY'='&lt;your_consumer_key&gt;'
# export 'API_SECRET_KEY'='&lt;your_consumer_secret&gt;'

consumer_key = os.environ.get("API_KEY")
consumer_secret = os.environ.get("API_SECRET_KEY")

# Be sure to add replace the text of the with the text you wish to Tweet. You can also add parameters to post polls, quote Tweets, Tweet with reply settings, and Tweet to Super Followers in addition to other features.
payload = {"text": "Hello world!"}

# Get request token
request_token_url = "https://api.twitter.com/oauth/request_token?oauth_callback=oob&amp;x_auth_access_type=write"
oauth = OAuth1Session(consumer_key, client_secret=consumer_secret)

try:
    fetch_response = oauth.fetch_request_token(request_token_url)
except ValueError:
    print(
        "There may have been an issue with the consumer_key or consumer_secret you entered."
    )

resource_owner_key = fetch_response.get("oauth_token")
resource_owner_secret = fetch_response.get("oauth_token_secret")
print("Got OAuth token: %s" % resource_owner_key)

# Get authorization
base_authorization_url = "https://api.twitter.com/oauth/authorize"
authorization_url = oauth.authorization_url(base_authorization_url)
print("Please go here and authorize: %s" % authorization_url)
verifier = input("Paste the PIN here: ")

# Get the access token
access_token_url = "https://api.twitter.com/oauth/access_token"
oauth = OAuth1Session(
    consumer_key,
    client_secret=consumer_secret,
    resource_owner_key=resource_owner_key,
    resource_owner_secret=resource_owner_secret,
    verifier=verifier,
)
oauth_tokens = oauth.fetch_access_token(access_token_url)

access_token = oauth_tokens["oauth_token"]
access_token_secret = oauth_tokens["oauth_token_secret"]

# Make the request
oauth = OAuth1Session(
    consumer_key,
    client_secret=consumer_secret,
    resource_owner_key=access_token,
    resource_owner_secret=access_token_secret,
)

# Making the request
response = oauth.post(
    "https://api.twitter.com/2/tweets",
    json=payload,
)

if response.status_code != 201:
    raise Exception(
        "Request returned an error: {} {}".format(response.status_code, response.text)
    )

print("Response code: {}".format(response.status_code))

# Saving the response as JSON
json_response = response.json()
print(json.dumps(json_response, indent=4, sort_keys=True))</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Run the code and you&#8217;ll have to authorize.</p>
</div>
<pre>
bash$ <strong>./twitter_create_tweet.py</strong>
Got OAuth token: tWBldQAAAAAAWBJgAAABggJt7qg
Please go here and authorize: https://api.twitter.com/oauth/authorize?oauth_token=tWBldQAAAAAAWBJgAAABggJt7qg
Paste the PIN here: <strong>4859044</strong>
Response code: 201
{
    "data": {
        "id": "1547963178700533760",
        "text": "Hello world!"
    }
}
</pre>
<div class="paragraph">
<p>Check your twitter account and you&#8217;ll see the new tweet.
Record the <strong>id</strong> number and we&#8217;ll use it next to delete the tweet.</p>
</div>
</div>
<div class="sect4">
<h5 id="_deleting_a_tweet">Deleting a tweet</h5>
<div class="paragraph">
<p>Use the code in <a href="#twitter_delete_code">Code to delete a tweet  (<em>twitter_delete_tweet.py</em>)</a> to delete a tweet.  Around line 15 is the <strong>id</strong> number.  Paste in the value returned above.</p>
</div>
<div id="twitter_delete_code" class="exampleblock">
<div class="title">Example 13. Code to delete a tweet  (<em>twitter_delete_tweet.py</em>)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">#!/usr/bin/env python
# From: https://github.com/twitterdev/Twitter-API-v2-sample-code/blob/main/Manage-Tweets/delete_tweet.py
from requests_oauthlib import OAuth1Session
import os
import json

# In your terminal please set your environment variables by running the following lines of code.
# export 'API_KEY'='&lt;your_consumer_key&gt;'
# export 'API_SECRET_KEY'='&lt;your_consumer_secret&gt;'

consumer_key = os.environ.get("API_KEY")
consumer_secret = os.environ.get("API_SECRET_KEY")

# Be sure to replace tweet-id-to-delete with the id of the Tweet you wish to delete. The authenticated user must own the list in order to delete
id = "1547963178700533760"

# Get request token
request_token_url = "https://api.twitter.com/oauth/request_token?oauth_callback=oob&amp;x_auth_access_type=write"
oauth = OAuth1Session(consumer_key, client_secret=consumer_secret)

try:
    fetch_response = oauth.fetch_request_token(request_token_url)
except ValueError:
    print(
        "There may have been an issue with the consumer_key or consumer_secret you entered."
    )

resource_owner_key = fetch_response.get("oauth_token")
resource_owner_secret = fetch_response.get("oauth_token_secret")
print("Got OAuth token: %s" % resource_owner_key)

# Get authorization
base_authorization_url = "https://api.twitter.com/oauth/authorize"
authorization_url = oauth.authorization_url(base_authorization_url)
print("Please go here and authorize: %s" % authorization_url)
verifier = input("Paste the PIN here: ")

# Get the access token
access_token_url = "https://api.twitter.com/oauth/access_token"
oauth = OAuth1Session(
    consumer_key,
    client_secret=consumer_secret,
    resource_owner_key=resource_owner_key,
    resource_owner_secret=resource_owner_secret,
    verifier=verifier,
)
oauth_tokens = oauth.fetch_access_token(access_token_url)

access_token = oauth_tokens["oauth_token"]
access_token_secret = oauth_tokens["oauth_token_secret"]

# Make the request
oauth = OAuth1Session(
    consumer_key,
    client_secret=consumer_secret,
    resource_owner_key=access_token,
    resource_owner_secret=access_token_secret,
)

# Making the request
response = oauth.delete("https://api.twitter.com/2/tweets/{}".format(id))

if response.status_code != 200:
    raise Exception(
        "Request returned an error: {} {}".format(response.status_code, response.text)
    )

print("Response code: {}".format(response.status_code))

# Saving the response as JSON
json_response = response.json()
print(json_response)</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To see many other examples, go to <a href="http://bit.ly/18AvSTW">iStrategyLabs' node-twitter GitHub page</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_5">Discussion</h4>
<div class="paragraph">
<p>This opens up many new possibilities. You can read a temperature sensor and tweet its value whenever it changes, or you can turn on an LED whenever a certain hashtag is used. What are you going to tweet?</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-08-09 13:40:24 -0400
</div>
</div>
</body>
</html>